---
description: 以下是关于浏览器TVSDK如何提供更新的主控清单的一些信息和示例。
title: 实时主控清单更新架构
translation-type: tm+mt
source-git-commit: 89bdda1d4bd5c126f19ba75a819942df901183d1
workflow-type: tm+mt
source-wordcount: '540'
ht-degree: 1%

---


# 实时主控清单更新架构{#live-master-manifest-update-architecture}

以下是关于浏览器TVSDK如何提供更新的主控清单的一些信息和示例。

默认情况下，此功能处于关闭状态。 如果应用程序通过设置更新频率（以分钟为单位）来打开它，则在每次更新间隔后都会执行以下步骤：

1. 浏览器TVSDK检查主控清单的上次修改时间和etag以确定文件是否已更新。

   如果时间和etag都发生更改，则文件被视为已修改。
1. 浏览器TVSDK分析新清单并根据更新的性质采取适当的操作。
1. 如果当前播放比特率与修改的清单的比特率匹配，则浏览器TVSDK将切换到新用户档案。

   新用户档案可以来自不同服务器或同一服务器，位速率相同。 在这种情况下，过渡是平滑的。
1. 如果新清单中不再存在当前播放比特率，Browser TVSDK将尝试在新清单中也存在的当前用户档案中查找比特率。

   * 如果找到匹配，则播放器首先切换到现有清单中的匹配比特率用户档案，并切换到更新清单中的匹配比特率用户档案。 这可确保过渡顺畅。
   * 如果上一个清单和新清单之间没有相同的比特率，或者如果浏览器TVSDK无法切换到匹配的比特率，则浏览器TVSDK直接切换到新清单的最低比特率用户档案，并使用ABR根据带宽切换到任何允许的比特率。 这可能导致播放出现轻微故障，但影响应该最小。

1. 如果更新成功，Browser TVSDK将调度`MediaPlayerItemEvent.MASTER_UPDATED`事件。
1. 如果更新不成功，则在此更新之前进行设置后，继续播放。

## 示例1 {#example_DB55F2B9D98741628C9B973E47A0B6A0}

以下位速率正在直播：

* 50万
* 90万
* 2100k

2100k流存在一些问题，因此需要重新启动。 主控清单更新为仅包含500k和900k。 不久之后，观看此项目的用户将体验到将位速率切换为900k的情况。 90万观看者继续90万观看。 稍后，2100k流恢复，并重新添加到主控清单中。 一会儿，90万观看且带宽为210万的用户将切换到210万。

### 示例2 {#example_485E9A9F373D454CADE5395DEC734E5D}

以下位速率正在直播：

* 50万
* 90万
* 2100k

所有这些比特率都需要重新启动。 为此，在400k和1500k上设置了两个时间流。 用户切换到400k ，这是新配置的最低比特率。 某些用户在带宽足够时会切换到1500k。 之后，备份三比特率并更新主控清单。 用户在500k时自动切换回观看，这是修订（原始）清单中最低的带宽。 稍后，用户将切换到其网络允许的最高带宽（900k或1200k）。

<!-- 

WRITER: Add relref to api/psdk/asdoc-dhls_1.4/com/adobe/mediacore/events/MediaPlayerItemEvent.html#MASTER_UPDATED

 -->

