---
description: 以下是有关Browser TVSDK如何容纳更新的主控清单的一些信息和示例。
title: 实时主控清单更新架构
exl-id: 2d9be228-7a96-4c19-828d-c1a4b0b07aa0
source-git-commit: be43bbbd1051886c8979ff590a3197b2a7249b6a
workflow-type: tm+mt
source-wordcount: '540'
ht-degree: 1%

---

# 实时主控清单更新架构{#live-master-manifest-update-architecture}

以下是有关Browser TVSDK如何容纳更新的主控清单的一些信息和示例。

默认情况下，此功能处于关闭状态。 如果您的应用程序通过设置更新频率（以分钟为单位）将其打开，则会在每个更新间隔后执行以下步骤：

1. Browser TVSDK会检查主控清单的上次修改时间和etag，以确定文件是否已更新。

   如果时间和etag均发生更改，则将该文件视为已修改。
1. 浏览器TVSDK将解析和分析新清单，并根据更新的性质采取适当操作。
1. 如果当前播放比特率与修改的清单的比特率匹配，则浏览器TVSDK切换到新配置文件。

   新配置文件可能来自不同的服务器或相同的服务器，具有相同的比特率。 在这种情况下，过渡是平滑的。
1. 如果新清单中不再存在当前播放比特率，则浏览器TVSDK会尝试在当前配置文件中查找新清单中同样存在的比特率。

   * 如果找到匹配，则播放器首先切换到现有清单中的匹配比特率配置文件，并切换到更新清单中的匹配比特率配置文件。 这可确保过渡平滑。
   * 如果前一清单与新清单之间没有共同的比特率，或者如果浏览器TVSDK无法切换到匹配的比特率，则浏览器TVSDK直接切换到新清单的最低比特率配置文件，并使用ABR根据带宽切换到任何允许的比特率。 这可能会导致播放出现轻微问题，但应该影响不大。

1. 如果更新成功，浏览器TVSDK将调度 `MediaPlayerItemEvent.MASTER_UPDATED` 事件。
1. 如果更新不成功，则继续播放在此更新之前进行的设置。

## 示例1 {#example_DB55F2B9D98741628C9B973E47A0B6A0}

以下比特率正在实时广播：

* 500k
* 900k
* 2100k

2100k流存在一些问题，因此需要重新启动。 主控清单已更新为仅包含500k和900k。 不久之后，在210k观看该节目的用户将体验到比特率切换到90k。 看着90万的用户继续看着90万。 之后，2100k流恢复，并将其添加回主控清单中。 一段时间后，在900k观看视频并且拥有带宽的用户切换到2100k。

### 示例2 {#example_485E9A9F373D454CADE5395DEC734E5D}

以下比特率正在实时广播：

* 500k
* 900k
* 2100k

所有这些比特率都需要重新启动。 在400k和1500k下，有两个时间流设置用于此目的。 用户切换到400k，这是新配置的最低比特率。 当带宽足够时，某些用户会被切换到1500k。 之后，备份三位速率并更新主控清单。 用户在500k自动切换回观看，这是修订（原始）清单中最低的带宽。 一段时间后，用户会切换到其网络允许的最高带宽（900k或1200k）。

<!-- 

WRITER: Add relref to api/psdk/asdoc-dhls_1.4/com/adobe/mediacore/events/MediaPlayerItemEvent.html#MASTER_UPDATED

 -->
