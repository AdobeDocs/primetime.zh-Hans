---
title: 提升临时通行证
description: 提升临时通行证
source-git-commit: 326f97d058646795cab5d062fa5b980235f7da37
workflow-type: tm+mt
source-wordcount: '1523'
ht-degree: 0%

---


# 提升临时通行证 {#promotional-temp-pass}

>[!NOTE]
>
>此页面上的内容仅供参考。 使用此API需要获得Adobe的当前许可证。 不允许未经授权使用。

## 功能摘要 {#feature-summary}

“促销临时通行证”允许程序员为没有MVPD帐户凭据的用户提供对其受保护内容的临时访问。

促销临时通行证设计为用于运行促销活动，其中用户在向程序员提供有效的标识信息（例如，电子邮件地址）之后，将能够使用 **预定义时间段内不同VOD标题的预定义数量**.

>[!IMPORTANT]
>
>Adobe不存储任何个人身份信息(PII)。 因此，程序员必须针对唯一用户提供的关于Primetime身份验证API的信息设置哈希。

促销临时通行证构建在 [临时通道](/help/authentication/temp-pass.md) 功能，这意味着它包含所有“临时传递”功能。

超过最大预定义VOD标题数或预定义时间段后，用户将无法在同一设备上访问内容，或者使用相同的用户标识符信息（例如，电子邮件地址）访问内容，直到授权令牌从Adobe Primetime身份验证服务器中清除为止。

>[!NOTE]
>
>Temp Pass是Premium Workflow包的一部分。 如果对使用此功能感兴趣，请联系您的Primetime销售代表。

## 临时通行证和促销临时通行证比较 {#tp-ptp-comparison}

| 临时通道 | 提升临时通行证 |
|----------------------------------|----------------------------------------------------------------------------------------|
| 访问内容 <ul><li>基于时间</li></ul> | 访问内容 <ul><li>基于时间</li><li>根据资源数</li></ul> |
| 访问安全性基于 <ul><li>设备ID</li></ul> | 安全性基于 <ul><li>设备ID</li><li>通过提供的用户标识符信息进行哈希处理（例如，电子邮件）</li></ul> |
| 客户端错误API可用 | 客户端错误API可用 |
| 重置/清除可用 | 重置/清除可用 |

## 功能详细信息 {#feature-details}

该功能使用户在在程序员应用程序中提供了唯一信息（如电子邮件地址）后，能够从特定设备（手机和平板电脑）访问促销内容。

程序员将在身份验证和授权API上通过用户PII提供哈希。 此哈希将与设备ID一起用于生成唯一键值以标识用户和设备。

根据设备ID和用户提供的信息，并按照以下逻辑进行操作，Adobe Primetime身份验证将确定用户是处于新试用版还是处于现有试用版中：

* 通过用户提供的信息（例如电子邮件）新建哈希信息，新设备ID =>新试用版
* 现有哈希过用户提供的信息（例如，电子邮件），新设备ID =>现有试用版(现有哈希过用户提供的信息（例如，电子邮件）)
* 通过用户提供的信息（例如电子邮件）新建哈希值，现有设备ID =>现有试用版（具有现有设备ID）
* 现有哈希值，超出用户提供的信息（例如电子邮件），现有设备ID =>现有试用版

>[!NOTE]
>用户提供信息的验证和哈希处理由程序员处理，而不是由Adobe处理。

**可以根据以下属性配置“促销临时通行证”功能：**

* 用户提供的信息键（例如，电子邮件）
* 用户有权使用的资源数
* TTL — 用户有权使用配置资源数的时间范围

### 用户元数据 {#user-metadata}

为方便程序员应用程序的实施， **用户元数据信息已公开** 在“促销临时通行证”上，使用相应的密钥(要激活密钥，请联系tve-support@adobe.com):

* **remaining_resources**:当前用户有权使用的剩余资源数
* **used_assets**:当前用户已使用的资源列表
* **expiration_date**:当前用户的过期日期

### 如何计算查看时间？ {#compute-viewing-time}

临时通行证保持有效的时间与用户在程序员应用程序上查看内容所花费的时间量无关。 在初始用户通过促销临时通道请求授权时，通过将初始当前请求时间添加到程序员指定的TTL（持续时间帧）来计算过期时间。

### 身份验证和授权 {#authn-authz}

对于促销临时通行流，验证和授权不会与实际的MVPD通信， **因此所有授权请求都会成功** 只要满足所有这些条件：

* 授权令牌对指定的资源有效
* 数量 **used_assets** 低于程序员设定的限制
* **expiration_date** 值晚于当前日期。

### 预检行为 {#preflight-beh}

当对促销临时通道MVPD发出预检或预授权请求时，返回的相应预检响应将包含预检成功时来自预检请求的整个资源列表。

其背后的逻辑是：促销临时通过授权条件基于时间和资源编号限制，而不是特定资源。 更具体地说，只要满足时间约束并且不超过资源限制，就会授权被调用的资源。

### 单点登录 {#sso}

对于“促销临时通道”的实例，未启用SSO，该实例配置了“每个请求者的身份验证”。 这意味着当用户从应用程序A切换到与同一促销临时通行证集成的其他应用程序B时，用户将不会自动登录。

### 注销 {#logout}

注销时，将删除设备上的所有令牌。 因此，从促销临时通行证切换到用户选择的常规MVPD时，不应依赖此实施。 建议使用 `setSelectedProvider(null)` 以清除应用程序状态，然后重新启动身份验证流程，这样可以获得更好的用户体验。

### 提升临时通道流程图 {#promo-tempass-flowdia}

![提升临时通道流程图](assets/promo-temp-pass-flow.png)

*图：提升临时通道流*

## 实施提升临时通行证 {#impl-promo-tempass}

促销临时通行证需要以下客户端功能：

* **用户标识符信息，例如电子邮件地址传播** （在身份验证和授权流上发送用户的电子邮件地址）。 Adobe Primetime身份验证要求使用电子邮件来绑定身份验证和授权令牌(类似于 `device_ID`，所有调用均为必需)。
* **强制验证**  — 允许程序员在用户已经进行身份验证时强制执行身份验证流程。 要强制刷新用户元数据（用户元数据键），需要此功能 **used_assets** 包含可用资源的数量)。 由于用户可以在多个设备上登录，因此应用程序启动期间设备上存在的用户元数据不可靠，我们需要更新该元数据以反映该特定用户的当前状态（由电子邮件地址标识）。


>[!IMPORTANT]
>只能在iOS和Android上进行强制身份验证。
>Primetime身份验证没有内置机制，无法在X分钟后停止免费流播放。 Primetime身份验证将停止发布 **授权** 和 **短媒体** 令牌：用户使用Y自由资源后。 升级临时通行证过期后，由程序员限制访问。

## 安全性 {#security}

>[!IMPORTANT]
>Adobe不存储任何个人身份信息(PII)。 因此，程序员必须针对唯一用户提供的关于Primetime身份验证API的信息设置哈希。

**用户标识符信息的哈希处理**

Adobe建议使用 **SHA-2** 家庭或特定 **SHA-256**, **SHA-512** 函数。

例如， **SHA-256** over **&quot;user@domain.com&quot;** is **&quot;f7ee5ec7312165148b69fcca1d29075b14b8aef0b5048a332b18b88d09069fb7&quot;**.

## 重置或清除提升临时通行证 {#reset-promo-tempass}

某些业务规则需要定期清除“促销临时通行证”。 为此，Primetime身份验证为程序员提供 *公共* web API，如下所述：

| `DELETE https://mgmt.auth.adobe.com/reset-tempass/v2/reset` |
|----|
| <ul><li>协议： **https**</li><li>主机：<ul><li>版本： **mgmt.auth.adobe.com**</li><li>前缀： **mgmt-prequal.auth.adobe.com**</li></ul></li><li>路径： **/reset-tempass/v2/reset**</li><li>查询参数： **device_id=all&amp;requestor_id=THE_REQUESTOR_ID&amp;mvpd_id=THE_TEMPASS_MVPD_ID**</li><li>标题：ApiKey: **1232293681726481**</li> <li>响应：<ul><li>成功： **HTTP 204**</li><li>失败： **HTTP 400** 对于不正确的请求， **HTTP 401** 如果未指定ApiKey， **HTTP 403** 如果ApiKey无效</li></ul></li></ul> |

除了清除临时通行证的要求之外，促销临时通行证还使用散列，而不是用户标识符信息， **generic_data** 进行清除的验证和授权。

将发送哈希，而不是整个JSON:

```cURL
$ curl -X DELETE -H "Authorization:Bearer H4j7cF3GtJX81BrsgDa10GwSizVz" "https://mgmt.auth.adobe.com/reset-tempass/v2.1/reset/generic?key=f7ee5ec7312165148b69fcca1d29075b14b8aef0b5048a332b18b88d09069fb7&requestor_id=REF&mvpd_id=FlexibleTempPass"
```

### 支持的客户端 {#supported-clients}

| Adobe Primetime身份验证客户端 | 提升临时通行证 | 重置工具 | 支持专用响应代码/客户端错误 |
|:--------------------------------------:|:---------------------:|:----------:|:-----------------------------------------------:|
| JS Access Enabler | 是 | 是 | 是（从v 3.0.0开始） |
| 本机客户端iOS | 是 | 是 | 是（从v 1.10开始） |
| 本机客户端Android | 是 | 是 | 是 |
| 无客户端API | 是 | 是 | 否 |


## 限制 {#limitations}

本节介绍适用于当前实施促销临时通行证的限制。

### 无客户端 {#lim-clientless}

**没有唯一设备ID的智能设备**

并非所有智能设备应用程序都能够提供唯一设备ID。 如果没有UUID，Adobe Primetime身份验证可以使用由Adobe注册代码服务生成的UUID作为唯一设备ID。 这意味着当用户注销时，将删除身份验证和授权令牌。 一旦用户尝试再次进行身份验证，此次使用不同的用户信息（例如电子邮件），用户将能够再次进行授权。 Adobe建议添加一个UI流程，该流程将不允许用户“愚弄”系统，并添加逻辑以确定它是请求试用版的新用户还是现有试用版。

**重置/清除临时通道**

在Xbox360和Xbox One的特定情况下，无客户端的“重置临时通行证”不可用，因为这些平台需要额外的设备ID解析，而在“重置临时通行证”工具中是不可能的。

<!--
>[!RELATEDINFORMATION]
>
>* [Preflight Authorization](/help/authentication/preflight-authz.md)
-->